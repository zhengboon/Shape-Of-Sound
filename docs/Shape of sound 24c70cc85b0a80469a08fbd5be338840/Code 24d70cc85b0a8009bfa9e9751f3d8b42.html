<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Code</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-default { background-color: rgba(84, 72, 49, 0.08); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="24d70cc8-5b0a-8009-bfa9-e9751f3d8b42" class="page sans"><header><h1 class="page-title">Code</h1><p class="page-description"></p></header><div class="page-body"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="24d70cc8-5b0a-80c8-85db-eca06f19743f" class="code code-wrap"><code class="language-C++" style="white-space:pre-wrap;word-break:break-all">#include &lt;SoftwareSerial.h&gt;
#include &lt;DFRobotDFPlayerMini.h&gt;
// A0 = RX, A1 = TX to DFPlayer
SoftwareSerial mySerial(A0, A1);  
DFRobotDFPlayerMini myDFPlayer;
const int busyPin = A2;


// Sensor-specific pin assignments
const int NUM_SENSORS = 4;
const int S2_PINS[NUM_SENSORS]  = {5, 7, 9, 11};
const int S3_PINS[NUM_SENSORS]  = {6, 8, 10, 12};
const int OUT_PINS[NUM_SENSORS] = {2, 3, 4, 13};

// Timing
unsigned long lastStepTime = 0;
const unsigned long STEP_INTERVAL = 1; // 1ms per loop
unsigned long lastDetectionTime[NUM_SENSORS] = {0};  // Lockout timers
const unsigned long lockoutDuration = 400; // ms
String classifyColor(int red, int green, int blue);

// Store RGB values
int redVals[NUM_SENSORS] = {0};
int greenVals[NUM_SENSORS] = {0};
int blueVals[NUM_SENSORS] = {0};
int avgVals[NUM_SENSORS] = {0};
String colour = &quot;&quot;;

void setup() {
  Serial.begin(9600);
  mySerial.begin(9600);      
  pinMode(busyPin, INPUT);

  for (int i = 0; i &lt; NUM_SENSORS; i++) {
    pinMode(S2_PINS[i], OUTPUT);
    pinMode(S3_PINS[i], OUTPUT);
    pinMode(OUT_PINS[i], INPUT);
  }

  Serial.println(F(&quot;Initializing DFPlayer...&quot;));
  if (!myDFPlayer.begin(mySerial, true, true)) {
    Serial.println(F(&quot;❌ DFPlayer init failed&quot;));
    //while (true);
  }
    Serial.println(F(&quot; DFPlayer init passed&quot;));

  myDFPlayer.volume(20);

  // Preload all 8 notes (optional preload sequence)
  myDFPlayer.play(2);  // preload silent track
  delay(1000);
  myDFPlayer.play(3);  // preload silent track
  delay(1000);
  myDFPlayer.play(4);  // preload silent track
  delay(1000);
 


  
}

int readColor(int sensorIndex, bool s2Val, bool s3Val) {
  digitalWrite(S2_PINS[sensorIndex], s2Val);
  digitalWrite(S3_PINS[sensorIndex], s3Val);
  delayMicroseconds(100);
  return pulseIn(OUT_PINS[sensorIndex], LOW, 5000);
}

void loop() {
  unsigned long now = millis();

  if (now - lastStepTime &gt;= STEP_INTERVAL) {
    lastStepTime = now;

    for (int i = 0; i &lt; NUM_SENSORS; i++) {
      redVals[i]   = readColor(i, LOW, LOW);
      greenVals[i] = readColor(i, HIGH, HIGH);
      blueVals[i]  = readColor(i, LOW, HIGH);
      avgVals[i]   = (redVals[i] + greenVals[i] + blueVals[i]) / 3;
    }

    for (int i = 0; i &lt; NUM_SENSORS; i++) {
    int brightness = avgVals[i];
      if (brightness &lt; 40 &amp;&amp; brightness &gt; 10) {
      
          Serial.print(i); Serial.print(&#x27;\t&#x27;);
          Serial.print(redVals[i]); Serial.print(&#x27;\t&#x27;);
          Serial.print(greenVals[i]); Serial.print(&#x27;\t&#x27;);
          Serial.print(blueVals[i]); Serial.print(&#x27;\t&#x27;);
          Serial.print(avgVals[i]);
          colour = classifyColor(redVals[i],greenVals[i],blueVals[i]);
          
          
          
          Serial.print(colour);
          
          Serial.println();
          
          if (now - lastDetectionTime[i] &gt; lockoutDuration) {
            switch(i){
              case 3:
              if (colour == &quot;Pink&quot;){
                myDFPlayer.play(21); 
              }
              else if (colour == &quot;Blue&quot;){
                myDFPlayer.play(25);
              }
              else if (colour == &quot;Green&quot;){
                myDFPlayer.play(29);
              }
              else if (colour == &quot;Yellow&quot;){
                myDFPlayer.play(33);
              }
              break;
              
            case 0:
              if (colour == &quot;Pink&quot;){
                myDFPlayer.play(18); 
              }
              else if (colour == &quot;Blue&quot;){
                myDFPlayer.play(22);
              }
              else if (colour == &quot;Green&quot;){
                myDFPlayer.play(26);
              }
              else if (colour == &quot;Yellow&quot;){
                myDFPlayer.play(30);
              }
              break;

              case 1:
              if (colour == &quot;Pink&quot;){
                myDFPlayer.play(19); 
              }
              else if (colour == &quot;Blue&quot;){
                myDFPlayer.play(23);
              }
              else if (colour == &quot;Green&quot;){
                myDFPlayer.play(27);
              }
              else if (colour == &quot;Yellow&quot;){
                myDFPlayer.play(31);
              }
              break;

              case 2:
              if (colour == &quot;Pink&quot;){
                myDFPlayer.play(20); 
              }
              else if (colour == &quot;Blue&quot;){
                myDFPlayer.play(24);
              }
              else if (colour == &quot;Green&quot;){
                myDFPlayer.play(28);
              }
              else if (colour == &quot;Yellow&quot;){
                myDFPlayer.play(32);
              }
              break;
            }
            

          lastDetectionTime[i] = now; // Start lockout
          
          }
          
        /*
        if (now - lastDetectionTime[i] &gt; lockoutDuration) {
            switch(i){
              case 0:
              if (colour == &quot;Pink&quot;){
                myDFPlayer.play(2); 
              }
              else if (colour == &quot;Blue&quot;){
                myDFPlayer.play(6);
              }
              else if (colour == &quot;Green&quot;){
                myDFPlayer.play(10);
              }
              else if (colour == &quot;Yellow&quot;){
                myDFPlayer.play(14);
              }
              break;
              
            case 1:
              if (colour == &quot;Pink&quot;){
                myDFPlayer.play(3); 
              }
              else if (colour == &quot;Blue&quot;){
                myDFPlayer.play(7);
              }
              else if (colour == &quot;Green&quot;){
                myDFPlayer.play(11);
              }
              else if (colour == &quot;Yellow&quot;){
                myDFPlayer.play(15);
              }
              break;

              case 2:
              if (colour == &quot;Pink&quot;){
                myDFPlayer.play(4); 
              }
              else if (colour == &quot;Blue&quot;){
                myDFPlayer.play(8);
              }
              else if (colour == &quot;Green&quot;){
                myDFPlayer.play(12);
              }
              else if (colour == &quot;Yellow&quot;){
                myDFPlayer.play(16);
              }
              break;

              case 3:
              if (colour == &quot;Pink&quot;){
                myDFPlayer.play(5); 
              }
              else if (colour == &quot;Blue&quot;){
                myDFPlayer.play(9);
              }
              else if (colour == &quot;Green&quot;){
                myDFPlayer.play(13);
              }
              else if (colour == &quot;Yellow&quot;){
                myDFPlayer.play(17);
              }
              break;
            }
            
        }*/
      }
    }
  }
}
#include &lt;math.h&gt;
/*
String classifyColor(int red, int green, int blue, bool debug = false) {
  int votesYellow = 0;
  int votesWhite = 0;

  // [0a] Glitch Protection
  if (blue &gt; 2000 &amp;&amp; red &lt; 400 &amp;&amp; green &lt; 400) {
    votesWhite += 2; if (debug) Serial.println(&quot;[0a] White +2&quot;);
  }

  // [0b] Blue not dominant → suppress yellow
  if (blue &lt; 650 || blue &lt; red || blue &lt; green) {
    votesWhite += 1; if (debug) Serial.println(&quot;[0b] White +1&quot;);
  }

  // [0c] Bright White Override
  if (red &gt; 1200 &amp;&amp; green &gt; 1200 &amp;&amp; blue &gt; 1200 &amp;&amp;
      abs(red - green) &lt; 250 &amp;&amp; abs(green - blue) &lt; 250 &amp;&amp;
      abs(red - blue) &lt; 250) {
    votesWhite += 2; if (debug) Serial.println(&quot;[0c] White +2&quot;);
  }

  // [0d] Yellow Forgiveness Layer
  if (blue &gt; 1300 &amp;&amp; (blue - red &gt; 200) &amp;&amp; (blue - green &gt; 150)) {
    votesYellow++; if (debug) Serial.println(&quot;[0d] Yellow +1&quot;);
  }

  // [0e] Blue-suppressed White patch
  if (red &gt; blue &amp;&amp; green &gt; blue &amp;&amp; red &gt; 1000 &amp;&amp; green &gt; 800) {
    votesWhite += 1; if (debug) Serial.println(&quot;[0e] White +1&quot;);
  }

  // [0f] Yellow lockout on low brightness
  int avg = (red + green + blue) / 3;
  if (avg &lt; 500) {
    votesWhite += 1; if (debug) Serial.println(&quot;[0f] White +1&quot;);
  }

  // [1] Absolute Thresholds
  if (red &lt; 700 &amp;&amp; green &gt; 800 &amp;&amp; blue &gt; 1300) {
    votesYellow++; if (debug) Serial.println(&quot;[1a] Yellow +1&quot;);
  }
  else if (red &gt; 600 &amp;&amp; green &gt; 600 &amp;&amp; blue &gt; 600 &amp;&amp;
           red &lt; 1500 &amp;&amp; green &lt; 1500 &amp;&amp; blue &lt; 1500) {
    votesWhite++; if (debug) Serial.println(&quot;[1b] White +1&quot;);
  }

  // [2] RGB Ratios
  float rOverG = (float)red / (green + 1);
  float bOverR = (float)blue / (red + 1);
  float gOverB = (float)green / (blue + 1);
  if (rOverG &lt; 0.85 &amp;&amp; bOverR &gt; 1.6) {
    votesYellow++; if (debug) Serial.println(&quot;[2a] Yellow +1&quot;);
  }
  else if (abs(rOverG - gOverB) &lt; 0.2 &amp;&amp; abs(gOverB - bOverR) &lt; 0.3) {
    votesWhite++; if (debug) Serial.println(&quot;[2b] White +1&quot;);
  }

  // [3] Brightness &amp; Balance
  if (avg &lt; 650 &amp;&amp; abs(red - green) &lt; 100 &amp;&amp; abs(green - blue) &lt; 100) {
    votesWhite += 2; if (debug) Serial.println(&quot;[3a] White +2&quot;);
  }
  else if (avg &gt; 850 &amp;&amp; avg &lt; 1150) {
    votesWhite++; if (debug) Serial.println(&quot;[3b] White +1&quot;);
  }
  else if (avg &gt; 950 &amp;&amp; blue &gt; red &amp;&amp; blue &gt; green) {
    votesYellow++; if (debug) Serial.println(&quot;[3c] Yellow +1&quot;);
  }

  // [4] Dominant Blue (stricter logic)
  if (blue &gt; 1100 &amp;&amp; red &lt; 800 &amp;&amp; green &lt; 800) {
    votesYellow++; if (debug) Serial.println(&quot;[4] Yellow +1&quot;);
  }

  // [5] Euclidean Distance (white-biased)
  float distYellow = sq(red - 559) + sq(green - 906) + sq(blue - 1427);
  float distWhite  = sq(red - 943) + sq(green - 1016) + sq(blue - 913);
  if (distWhite * 0.95 &lt; distYellow) {
    votesWhite++; if (debug) Serial.println(&quot;[5] White +1&quot;);
  } else {
    votesYellow++; if (debug) Serial.println(&quot;[5] Yellow +1&quot;);
  }

  // [6] Delta Signatures
  int drg = red - green;
  int drb = red - blue;
  int dgb = green - blue;
  if (abs(drg) &lt; 100 &amp;&amp; abs(drb) &lt; 100 &amp;&amp; abs(dgb) &lt; 100) {
    votesWhite++; if (debug) Serial.println(&quot;[6a] White +1&quot;);
  }
  else if (drg &lt; -250 &amp;&amp; dgb &lt; -300) {
    votesYellow++; if (debug) Serial.println(&quot;[6b] Yellow +1&quot;);
  }

  // [7] dB Band
  float redDB = 20 * log10((float)red + 1);
  float greenDB = 20 * log10((float)green + 1);
  float blueDB = 20 * log10((float)blue + 1);
  float maxDB = max(redDB, max(greenDB, blueDB));
  float minDB = min(redDB, min(greenDB, blueDB));
  if ((maxDB - minDB) &lt; 2.5) {
    votesWhite++; if (debug) Serial.println(&quot;[7a] White +1&quot;);
  }
  else if ((blueDB - redDB &gt; 3) &amp;&amp; (blueDB - greenDB &gt; 1.5)) {
    votesYellow++; if (debug) Serial.println(&quot;[7b] Yellow +1&quot;);
  }

  // [8] Saturation
  float maxRGB = max(red, max(green, blue));
  float minRGB = min(red, min(green, blue));
  float saturation = (maxRGB - minRGB) / (maxRGB + 1);
  if (saturation &lt; 0.1) {
    votesWhite++; if (debug) Serial.println(&quot;[8] White +1&quot;);
  }

  // [9] Pattern Logic
  bool rDom = red &gt; green &amp;&amp; red &gt; blue;
  bool gDom = green &gt; red &amp;&amp; green &gt; blue;
  bool bDom = blue &gt; red &amp;&amp; blue &gt; green;
  if (bDom &amp;&amp; gDom &amp;&amp; !rDom &amp;&amp; blue &gt; 700) {
    votesYellow++; if (debug) Serial.println(&quot;[9] Yellow +1&quot;);
  }

  if (debug) {
    Serial.print(&quot;Votes — Yellow: &quot;);
    Serial.print(votesYellow);
    Serial.print(&quot; | White: &quot;);
    Serial.println(votesWhite);
  }

  return (votesYellow &gt;= votesWhite) ? &quot;Yellow&quot; : &quot;White&quot;;
}

*/

#include &lt;math.h&gt;

const int K = 7;

const uint8_t trainingRGB[200][3] = {
  {54.0,42.0,31.0},
  {48.0,35.0,25.0},
  {44.0,31.0,21.0},
  {50.0,36.0,20.0},
  {48.0,32.0,20.0},
  {46.0,33.0,22.0},
  {64.0,47.0,33.0},
  {58.0,52.0,39.0},
  {58.0,49.0,36.0},
  {60.0,46.0,33.0},
  {63.0,45.0,32.0},
  {65.0,48.0,33.0},
  {59.0,50.0,31.0},
  {58.0,51.0,38.0},
  {51.0,36.0,26.0},
  {52.0,45.0,32.0},
  {51.0,35.0,25.0},
  {52.0,41.0,29.0},
  {60.0,48.0,25.0},
  {66.0,48.0,33.0},
  {65.0,47.0,26.0},
  {46.0,32.0,22.0},
  {50.0,31.0,21.0},
  {54.0,39.0,21.0},
  {56.0,48.0,36.0},
  {62.0,50.0,36.0},
  {58.0,49.0,37.0},
  {60.0,49.0,24.0},
  {46.0,28.0,19.0},
  {45.0,27.0,18.0},
  {55.0,46.0,34.0},
  {48.0,34.0,23.0},
  {51.0,38.0,28.0},
  {41.0,35.0,25.0},
  {46.0,32.0,22.0},
  {57.0,36.0,29.0},
  {57.0,32.0,26.0},
  {59.0,39.0,26.0},
  {52.0,42.0,30.0},
  {50.0,35.0,26.0},
  {60.0,47.0,33.0},
  {42.0,27.0,19.0},
  {51.0,33.0,22.0},
  {49.0,36.0,25.0},
  {59.0,54.0,35.0},
  {53.0,46.0,32.0},
  {58.0,49.0,37.0},
  {44.0,29.0,20.0},
  {59.0,38.0,32.0},
  {61.0,49.0,34.0},
  {31.0,25.0,25.0},
  {37.0,31.0,39.0},
  {48.0,40.0,44.0},
  {36.0,29.0,31.0},
  {44.0,39.0,42.0},
  {30.0,25.0,32.0},
  {42.0,33.0,43.0},
  {33.0,27.0,27.0},
  {52.0,44.0,50.0},
  {42.0,26.0,43.0},
  {48.0,42.0,45.0},
  {56.0,47.0,41.0},
  {53.0,46.0,48.0},
  {52.0,43.0,40.0},
  {39.0,29.0,32.0},
  {51.0,46.0,47.0},
  {47.0,42.0,44.0},
  {53.0,43.0,34.0},
  {48.0,38.0,47.0},
  {51.0,41.0,48.0},
  {49.0,40.0,48.0},
  {38.0,31.0,38.0},
  {41.0,33.0,42.0},
  {36.0,29.0,37.0},
  {38.0,31.0,31.0},
  {38.0,32.0,38.0},
  {52.0,43.0,40.0},
  {48.0,39.0,38.0},
  {46.0,38.0,36.0},
  {50.0,45.0,47.0},
  {36.0,29.0,36.0},
  {34.0,28.0,29.0},
  {56.0,46.0,41.0},
  {49.0,41.0,49.0},
  {39.0,42.0,44.0},
  {40.0,33.0,41.0},
  {53.0,43.0,34.0},
  {49.0,39.0,48.0},
  {46.0,40.0,45.0},
  {43.0,37.0,41.0},
  {45.0,39.0,43.0},
  {52.0,48.0,48.0},
  {34.0,25.0,31.0},
  {46.0,40.0,44.0},
  {46.0,40.0,44.0},
  {37.0,27.0,32.0},
  {33.0,24.0,30.0},
  {45.0,46.0,47.0},
  {45.0,35.0,36.0},
  {50.0,41.0,47.0},
  {39.0,49.0,35.0},
  {42.0,56.0,39.0},
  {44.0,61.0,36.0},
  {40.0,45.0,31.0},
  {20.0,29.0,20.0},
  {40.0,53.0,37.0},
  {38.0,52.0,36.0},
  {25.0,33.0,28.0},
  {40.0,46.0,32.0},
  {43.0,60.0,42.0},
  {39.0,49.0,36.0},
  {33.0,42.0,29.0},
  {33.0,35.0,32.0},
  {41.0,47.0,26.0},
  {41.0,50.0,38.0},
  {40.0,50.0,38.0},
  {30.0,42.0,30.0},
  {34.0,45.0,33.0},
  {21.0,32.0,22.0},
  {41.0,46.0,32.0},
  {46.0,53.0,41.0},
  {24.0,36.0,25.0},
  {47.0,55.0,42.0},
  {25.0,37.0,26.0},
  {45.0,58.0,41.0},
  {44.0,43.0,34.0},
  {24.0,37.0,19.0},
  {42.0,49.0,39.0},
  {28.0,39.0,28.0},
  {26.0,37.0,26.0},
  {21.0,31.0,22.0},
  {36.0,52.0,36.0},
  {46.0,50.0,35.0},
  {40.0,47.0,33.0},
  {42.0,51.0,38.0},
  {35.0,47.0,35.0},
  {34.0,50.0,34.0},
  {31.0,39.0,31.0},
  {26.0,40.0,28.0},
  {27.0,33.0,27.0},
  {22.0,30.0,20.0},
  {43.0,54.0,41.0},
  {52.0,53.0,30.0},
  {30.0,44.0,31.0},
  {41.0,50.0,42.0},
  {22.0,31.0,22.0},
  {24.0,38.0,25.0},
  {48.0,60.0,37.0},
  {26.0,39.0,28.0},
  {19.0,28.0,19.0},
  {20.0,26.0,34.0},
  {21.0,28.0,34.0},
  {30.0,34.0,44.0},
  {37.0,38.0,36.0},
  {37.0,42.0,46.0},
  {21.0,25.0,32.0},
  {31.0,34.0,38.0},
  {46.0,45.0,40.0},
  {46.0,49.0,47.0},
  {46.0,45.0,52.0},
  {37.0,40.0,37.0},
  {39.0,38.0,36.0},
  {26.0,35.0,41.0},
  {23.0,28.0,30.0},
  {30.0,39.0,44.0},
  {19.0,24.0,26.0},
  {19.0,24.0,32.0},
  {26.0,32.0,32.0},
  {39.0,41.0,38.0},
  {25.0,29.0,34.0},
  {38.0,40.0,37.0},
  {39.0,49.0,50.0},
  {19.0,23.0,31.0},
  {44.0,47.0,54.0},
  {26.0,31.0,36.0},
  {35.0,41.0,46.0},
  {33.0,37.0,40.0},
  {36.0,44.0,44.0},
  {34.0,39.0,45.0},
  {45.0,44.0,39.0},
  {43.0,51.0,54.0},
  {22.0,23.0,27.0},
  {49.0,52.0,48.0},
  {22.0,30.0,34.0},
  {38.0,42.0,43.0},
  {18.0,23.0,29.0},
  {30.0,38.0,33.0},
  {32.0,37.0,35.0},
  {53.0,51.0,42.0},
  {42.0,53.0,53.0},
  {39.0,44.0,48.0},
  {20.0,27.0,33.0},
  {19.0,21.0,26.0},
  {26.0,26.0,29.0},
  {49.0,47.0,40.0},
  {33.0,36.0,36.0},
  {25.0,34.0,38.0},
  {34.0,37.0,37.0},
  {19.0,25.0,31.0},
  {32.0,37.0,43.0},
};

    const char* trainingLabels[200] = {
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Blue&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Green&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Pink&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
  &quot;Yellow&quot;,
};

    String classifyColor(int r, int g, int b) {
      int bestIndex = -1;
      int bestDist = 999999;

      for (int i = 0; i &lt; 200; i++) {
        int dr = r - trainingRGB[i][0];
        int dg = g - trainingRGB[i][1];
        int db = b - trainingRGB[i][2];
        int dist = dr * dr + dg * dg + db * db;

        if (dist &lt; bestDist) {
          bestDist = dist;
          bestIndex = i;
        }
      }
      return String(trainingLabels[bestIndex]);
    }



</code></pre></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>